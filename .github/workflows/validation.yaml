name: "Validation"

on:
  push:
    branches: [ main ]

jobs:

  build:
    name: "project compilation and testing"
    runs-on: "ubuntu-latest"
    permissions:
      contents: write

    steps:

      - name: "checkout project"
        uses: "actions/checkout@v4"

      - name: "setup Java 21"
        uses: "actions/setup-java@v4"
        with:
          distribution: "temurin"
          java-version: "21"

      - name: "maven - verify"
        run: "mvn verify --no-transfer-progress --errors"

      - name: "generate JaCoCo badge"
        uses: "cicirello/jacoco-badge-generator@v2"

      - name: "commit JaCoCo badge"
        uses: "stefanzweifel/git-auto-commit-action@v5"
        with:
          commit_message: "autogenerated JaCoCo coverage badge"
